+++
id = "TASK-20250513T132917"
title = "Enhance Feature and Area Support in CLI and MCP"
type = "üåü Feature"
status = "üü° To Do"
priority = "üîº High"
created_date = "2025-05-13"
updated_date = "2025-05-13"
assigned_to = "dev-typescript"
phase = "release-v1"
subdirectory = "FEATURE_MDTMStandard"
tags = [ "feature", "area", "mdtm", "overview", "hierarchy" ]
+++

# Enhance Feature and Area Support in CLI and MCP

## Description ‚úçÔ∏è

This task focuses on improving the support for MDTM feature and area directories within both the CLI and MCP interfaces. Currently, the system has basic support for subdirectories but lacks dedicated commands and proper handling of feature/area relationships, overview files, and hierarchical task management.

The implementation will enhance how features and areas are created, managed, and displayed, ensuring better compatibility with the MDTM specification while maintaining a clean, intuitive interface for users.

## Acceptance Criteria ‚úÖ

* - [ ] Fix task listings to properly handle overview files (not showing as regular tasks)
* - [ ] Add dedicated commands for feature/area CRUD operations
  * - [ ] `feature create` command to create feature directories with overview files
  * - [ ] `feature list` command to list available features
  * - [ ] `feature update` command to update feature metadata
  * - [ ] `feature delete` command to delete features
  * - [ ] Equivalent commands for area management
* - [ ] Improve representation of tasks within features
  * - [ ] Better display format showing feature hierarchy
  * - [ ] Feature-aware task listing and filtering
* - [ ] Implement automatic template handling for feature/area creation
  * - [ ] Smart template selection for _overview files
  * - [ ] Proper content integration from command parameters
* - [ ] Add calculated feature status based on subtasks
  * - [ ] Show completion percentage in feature listings
  * - [ ] Filter features by progress status
* - [ ] Add task movement operations
  * - [ ] Commands to move tasks between features
  * - [ ] Bulk operations support
* - [ ] Improve CLI display for feature-centric views
* - [ ] Add equivalent MCP methods for all new functionality
* - [ ] Create detailed MCP tool descriptions for each new method
* - [ ] Add comprehensive tests for new feature/area functionality
* - [ ] Update documentation to reflect new feature/area capabilities

## Implementation Notes / Sub-Tasks üìù

### Architecture and Code Organization

* - [ ] Follow existing architecture patterns with clear separation of concerns:
  * - [ ] Implement core functionality in `src/core/` modules (task-manager.ts, template-manager.ts)
  * - [ ] Add CLI wrappers in `src/cli/` modules (cli.ts, commands.ts)
  * - [ ] Add MCP handlers in `src/mcp/` modules (handlers.ts, types.ts)
* - [ ] Reference existing patterns:
  * - [ ] Follow the pattern used for phases in task-manager.ts (listPhases, createPhase, etc.)
  * - [ ] Follow the pattern used for task/phase CLI commands in commands.ts
  * - [ ] Follow the pattern used for task/phase MCP methods in handlers.ts

### Core Functionality (task-manager.ts)

* - [ ] Add feature/area management core functions
  * - [ ] `listFeatures()` to list feature directories and their overview information
  * - [ ] `getFeature()` to get details about a specific feature
  * - [ ] `createFeature()` to create a new feature directory with _overview file
  * - [ ] `updateFeature()` to update feature metadata
  * - [ ] `deleteFeature()` to delete a feature directory
  * - [ ] Equivalent functions for area management

* - [ ] Enhance task listing to properly handle overview files
  * - [ ] Update `listTasks()` to exclude _overview files by default
  * - [ ] Add option to include overview files in task listings
  * - [ ] Add option to only show overview files

* - [ ] Implement feature/task relationship improvements
  * - [ ] Enhance task metadata to better represent feature relationship
  * - [ ] Add functions to calculate feature completion percentage based on tasks

* - [ ] Add task movement operations
  * - [ ] Function to move tasks between features
  * - [ ] Functions for bulk operations on tasks within a feature

### CLI Commands (cli.ts, commands.ts)

* - [ ] Add CLI commands for feature management (thin wrappers around core functions)
  * - [ ] `sc feature create` command
  * - [ ] `sc feature list` command
  * - [ ] `sc feature get` command
  * - [ ] `sc feature update` command
  * - [ ] `sc feature delete` command

* - [ ] Add CLI commands for area management (thin wrappers around core functions)
  * - [ ] `sc area create` command
  * - [ ] `sc area list` command
  * - [ ] `sc area get` command
  * - [ ] `sc area update` command
  * - [ ] `sc area delete` command

* - [ ] Add task movement commands
  * - [ ] `sc task move` command to move tasks between features/areas

* - [ ] Enhance task listing commands
  * - [ ] Update `sc task list` with feature/area filtering options
  * - [ ] Add hierarchical display options for task listings

### MCP Methods (handlers.ts, types.ts)

* - [ ] Add MCP methods for feature management (thin wrappers around core functions)
  * - [ ] `feature_list` method
  * - [ ] `feature_get` method
  * - [ ] `feature_create` method
  * - [ ] `feature_update` method
  * - [ ] `feature_delete` method

* - [ ] Add MCP methods for area management (thin wrappers around core functions)
  * - [ ] `area_list` method
  * - [ ] `area_get` method
  * - [ ] `area_create` method
  * - [ ] `area_update` method
  * - [ ] `area_delete` method

* - [ ] Add MCP methods for task movement
  * - [ ] `task_move` method

* - [ ] Update task-related MCP methods
  * - [ ] Enhance `task_list` method with feature/area options
  * - [ ] Update method return types to include hierarchical information

* - [ ] Create detailed MCP tool descriptions
  * - [ ] Write comprehensive documentation for each new MCP method
  * - [ ] Include parameter descriptions and examples
  * - [ ] Update docs/mcp-tool-descriptions.md
  * - [ ] Add examples of JSON request/response formats

### Template Handling (template-manager.ts)

* - [ ] Add smart template selection for feature/area creation
  * - [ ] Automatic template selection based on feature/area type
  * - [ ] Content integration from command parameters

### Testing and Documentation

* - [ ] Add unit tests for all new core functions
* - [ ] Add E2E tests for CLI commands
* - [ ] Add tests for MCP methods
* - [ ] Update documentation
  * - [ ] Update README.md
  * - [ ] Update CLAUDE.md
  * - [ ] Update example commands in all docs

## Design Considerations üìä

### Code Organization

```
// Core implementation (src/core/task-manager.ts)
export async function listFeatures(options?: FeatureFilterOptions): Promise<OperationResult<Feature[]>> {
  // Implementation here
}

// CLI wrapper (src/cli/commands.ts)
export async function handleFeatureListCommand(options: FeatureListCommandOptions): Promise<void> {
  const result = await listFeatures(options);
  // Handle CLI output formatting
}

// MCP wrapper (src/mcp/handlers.ts)
export async function handleFeatureList(params: FeatureListParams): Promise<OperationResult<Feature[]>> {
  return await listFeatures(params);
}
```

### Feature Representation

```
Features will be represented in a hierarchical structure:

FEATURE_Authentication/
  _overview.md            (Feature metadata, description, subtasks)
  001_login_ui.md         (Task)
  002_login_logic.md      (Task)

Task listing with hierarchy:
‚îî‚îÄ‚îÄ Authentication Feature
    ‚îú‚îÄ‚îÄ Login UI
    ‚îî‚îÄ‚îÄ Login Logic API Call
```

### Feature Status Calculation

```
Feature status will be calculated based on subtask status:

- Not Started: All subtasks are "To Do"
- In Progress: At least one subtask is "In Progress"
- Nearly Complete: >80% of subtasks are "Done", none are "Blocked"
- Blocked: At least one subtask is "Blocked"
- Complete: All subtasks are "Done"

Progress percentage = (# of completed tasks / total # of tasks) * 100
```

### Command Structure

```
Feature management commands:
sc feature create --name "Authentication" --description "User authentication features"
sc feature list [--format table|json] [--phase <phase>]
sc feature get <feature-id> [--format default|json]
sc feature update <feature-id> --name "New Name" --description "Updated description"
sc feature delete <feature-id> [--force]

Task movement:
sc task move <task-id> --to-feature <feature-id>
```

### MCP Tool Descriptions

```json
// Example MCP tool description for feature_list
{
  "name": "mcp__scopecraft-cmd__feature_list",
  "description": "List all features in the current project",
  "parameters": {
    "phase": "Optional phase to filter features by",
    "format": "Optional output format (json, table)",
    "include_tasks": "Include tasks within features in response (default: false)",
    "include_progress": "Include calculated progress metrics (default: true)"
  },
  "returns": "List of feature objects with metadata and optional task information",
  "example": {
    "method": "feature_list",
    "params": {
      "phase": "release-v1",
      "include_progress": true
    }
  }
}
```

## Review Notes üëÄ

* Consider usability in large projects with many features
* Ensure backward compatibility with existing task structure
* Verify proper handling of special characters in feature/area names
* Test with both CLI and MCP interfaces to ensure consistent behavior
* Review tool descriptions for clarity and completeness
* Look at existing patterns in the codebase for phase management as a reference
